add_namespace = nuke_time_calc

country_event = {
	id = nuke_time_calc.1
	hidden = yes

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				check_variable = { enrichment_max_time < 230 }
			}
			add_to_variable = { enrichment_max_time = enrichment_max_add_time }
			country_event = { id = nuke_time_calc.1 hours = 24 }
		}
		if = {
			limit = {
				OR = {
					check_variable = { enrichment_max_time > 230 }
					check_variable = { enrichment_max_time = 230 }
				}
			}
			add_to_variable = { Root.enricheduraniumstock = Root.UraniumToEnrichFinal }
			clear_variable = enrichment_max_time
			clear_variable = enrichment_time_left
			clear_variable = UraniumToEnrichFinal
			clear_variable = enrichment_calculation
			clear_variable = enrichment_result_calculation
			clear_variable = enrichment_price_calcualtion
			clear_variable = enrichmentcosts
			clear_variable = enrichmentresult
			clear_variable = enrichementdaysneeded
			clear_variable = enrichment_max_add_time
			clr_country_flag = enriching
		}
	}

	option = {
	}
}

country_event = {
	id = nuke_time_calc.2
	hidden = yes

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				check_variable = { building_max_time < 230 }
			}
			add_to_variable = { building_max_time = building_max_add_time }
			country_event = { id = nuke_time_calc.2 hours = 24 }
		}
		if = {
			limit = {
				OR = {
					check_variable = { building_max_time > 230 }
					check_variable = { building_max_time = 230 }
				}
			}
			add_nuclear_bombs = Root.NukesToBuildFinal
			clear_variable = building_max_time
			clear_variable = building_max_add_time
			clear_variable = NukesToBuildFinal
			clear_variable = nuke_calculation
			clear_variable = nuke_time_calculation
			clear_variable = nuke_costs_calculation
			clear_variable = buildingcosts
			clear_variable = buildingdaysneeded
			clear_variable = HEUNeeded
			clr_country_flag = building_nuke
		}
	}

	option = {
	}
}

#######################################
# Nuclear Bomb Events Written by swf541
#######################################

add_namespace = nuke_dropped

news_event = {
	id = nuke_dropped.100

	major = yes

	is_triggered_only = yes

	hidden = yes


	immediate = {
	    add_to_variable = { global.nuclear_winter = 1 }
		ROOT = {		
            add_named_threat = { threat = 20 name = "Nuclear Attack" }				
		}
		every_enemy_country = {
			limit = { owns_state = FROM }
			add_war_support = -15
		}
		FROM = {
			remove_building = { type = arms_factory level = 10 }
			remove_building = { type = industrial_complex level = 10 }
			remove_building = { type = air_base level = 10 }
			remove_building = { type = infrastructure level = 10 }
			remove_building = { type = industrial_complex level = 10 }
			remove_building = { type = arms_factory level = 10 }
			remove_building = { type = dockyard level = 10 }
			remove_building = { type = anti_air_building level = 10 }
			remove_building = { type = radar_station level = 10 }
			remove_building = { type = rocket_site level = 10 }
			set_state_category = nuclear_wasteland
		}
		if = {
			limit = {
				
				FROM = { 
					state_population > 50000
					NOT = { state_population > 100000 }
				}				
			}
			FROM = {
				add_manpower = -20000
				
				
			}
		}
		if = {
			limit = {
				
				FROM = { 
					state_population > 100000
					NOT = { state_population > 500000 }
				}				
			}
			FROM = {
				add_manpower = -80000
				
				
			}
		}
		if = {
			limit = {
				
				FROM = { 
					state_population > 1000000
					NOT = { state_population > 2000000 }
				}				
			}
			FROM = {
				add_manpower = -600000
				
				
			}
		}
		if = {
			limit = {
				
				FROM = { 
					state_population > 2000000
					NOT = { state_population > 5000000 }
				}				
			}
			FROM = {
				add_manpower = -1500000
				
				
			}
		}
		if = {
			limit = {
				
				FROM = { 
					state_population > 5000000
					NOT = { state_population > 10000000 }
				}				
			}
			FROM = {
				add_manpower = -5000000
				
				
			}
		}
		if = {
			limit = {
				
				FROM = { 
					state_population > 10000000
				}		
			}
			FROM = {
				add_manpower = -30000000
				
				
			}
		}
	}
	
	option = {
		# name = dummy_nuke_option
	}
}